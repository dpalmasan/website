<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Inteligencia Artificial: Agentes y Conceptos B√°sicos | Mr Dipalma‚Äôs Pub üç∫</title>
<meta name="generator" content="Jekyll v3.10.0">
<meta property="og:title" content="Inteligencia Artificial: Agentes y Conceptos B√°sicos">
<meta name="author" content="dpalmasan">
<meta property="og:locale" content="en_US">
<meta name="description" content="Introducci√≥n">
<meta property="og:description" content="Introducci√≥n">
<link rel="canonical" href="https://dpalmasan.github.io/website/algorithms/ai/2024/06/20/agents-ai.html">
<meta property="og:url" content="https://dpalmasan.github.io/website/algorithms/ai/2024/06/20/agents-ai.html">
<meta property="og:site_name" content="Mr Dipalma‚Äôs Pub üç∫">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2024-06-20T23:22:00+00:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Inteligencia Artificial: Agentes y Conceptos B√°sicos">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"dpalmasan"},"dateModified":"2024-06-20T23:22:00+00:00","datePublished":"2024-06-20T23:22:00+00:00","description":"Introducci√≥n","headline":"Inteligencia Artificial: Agentes y Conceptos B√°sicos","mainEntityOfPage":{"@type":"WebPage","@id":"https://dpalmasan.github.io/website/algorithms/ai/2024/06/20/agents-ai.html"},"url":"https://dpalmasan.github.io/website/algorithms/ai/2024/06/20/agents-ai.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css">
    <link rel="stylesheet" href="/website/assets/css/style.css">
    <style type="text/css">
        div#disqus_thread iframe[sandbox] {
                max-height: 0px !important;
        }
    </style>
<link type="application/atom+xml" rel="alternate" href="https://dpalmasan.github.io/website/feed.xml" title="Mr Dipalma's Pub üç∫">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KHXBX5G1VP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KHXBX5G1VP');
</script>

<script>MathJax={"tex":{"inlineMath":[["$","$"],["\\(","\\)"]],"displayMath":[["$$","$$"],["\\[","\\]"]]},"svg":{"fontCache":"global"}}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
<header class="site-header">

  <div class="wrapper">
<a class="site-title" rel="author" href="/website/">Mr Dipalma's Pub üç∫</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger">
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewbox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/website/about/">About</a></div>
      </nav>
</div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Inteligencia Artificial: Agentes y Conceptos B√°sicos</h1>
    <p class="post-meta"><time class="dt-published" datetime="2024-06-20T23:22:00+00:00" itemprop="datePublished">
        Jun 20, 2024
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="introduccin">Introducci√≥n</h1>
<p>En estos momentos estoy en Suvarnabhumi Airport, en Bangkok, en el Sakura Lounge de Japan Airlines, esperando para tomar mi vuelo de vuelta a Seattle. ¬°Rayos! Las vacaciones pasan r√°pido. El art√≠culo de hoy ser√° sobre conceptos b√°sicos de inteligencia artificial, en particular ‚Äúagentes‚Äù, ya este t√©rmino est√° empezando a sonar bastante con la tendencia de utilizar LLMs en la actualidad. Mi art√≠culo, sin embargo, ser√° un poco m√°s simple e intentar√° introducir el concepto de manera intuitiva.</p>
<h1 id="conceptos-de-ia">Conceptos de IA</h1>
<p>Definir qu√© es la inteligencia artificial puede ser pol√©mico, por lo que no dar√© una definici√≥n directamente en esta ocasi√≥n. El libro de Peter Norvig Artificial Intelligence: A modern approach tiene un cap√≠tulo introductorio fascinante. El nombre de Inteligencia Artificial para este campo de estudio, fue dado en 1956, aunque anteriormente hubo investigaciones ligadas a lo que desde entonces se conoce como Inteligencia Artificial. Es m√°s, √©ste campo multidisciplinario toma conocimiento y teor√≠a de: filosof√≠a, lenguaje, psicolog√≠a, neurociencia, econom√≠a, etc (en teor√≠a podr√≠amos estar hablando que la teor√≠a asociada existe desde la √©poca de Arist√≥teles).</p>
<p>El nombre de IA ha perdurado en el tiempo, pero lo que estudia se asemeja con la racionalidad computacional. La raz√≥n de ello, es que en t√©rminos de ‚Äúinteligencia‚Äù, la inteligencia artificial considera agentes que toman decisiones de forma racional, idealmente, toma la mejor decisi√≥n dada una situaci√≥n.</p>
<h2 id="agentes-en-ia">Agentes en IA</h2>
<p>Primero deber√≠amos definir qu√© es un agente, para luego definir qu√© es un agente inteligente. Un agente, es cualquier ente que pueda percibir su entorno a trav√©s de sensores y ejecutar acciones dentro del entorno mediante actuadores, tal como muestra la figura 1. La caja con el signo de interrogaci√≥n, es qu√© razonamiento/inteligencia se le provee al agente para que tome acciones dada una percepci√≥n del entorno.</p>
<div align="center">
<p><img src="https://gist.githubusercontent.com/dpalmasan/103d61ae06cfd3e7dee7888b391c1792/raw/e3206b8dbdc29f3a687960a72cdd682d5c6339a8/agents-act.png" alt="agent"></p>
<p><em>Fig 1: Interacci√≥n entre agente y entorno en alto nivel.</em></p>
</div>
<p>Cabe destacar que esta noci√≥n de agente es una herramienta para analizar sistemas, no es una caracterizaci√≥n que define qu√© es y qu√© no es un agente.</p>
<h2 id="agente-racional">Agente Racional</h2>
<p>Ahora que definimos un agente, hay que definir qu√© es un agente racional. Un agente racional es un agente que toma la acci√≥n correcta, algunos ejemplos: El controlador de aire acondicionado, esperar√≠amos que manejara la temperatura acorde a la temperatura configurada (aunque en mi experiencia personal, esto a veces no resulta jeje); una aspiradora roomba, esperar√≠amos que limpiara satisfactoriamente una habitaci√≥n dada.</p>
<p>Pero, desde el punto de vista de IA ¬øQu√© podr√≠a definirse como racionalidad? En realidad, lo que es racional depende de cuatro factores:</p>
<ul>
<li>La m√©trica de rendimiento que define un criterio de √©xito.</li>
<li>El conocimiento previo del agente respecto al entorno donde opera.</li>
<li>Las acciones que el agente puede tomar</li>
<li>Las percepciones del agente en un momento dado.</li>
</ul>
<h2 id="omnipotencia">¬øOmnipotencia?</h2>
<p>Aqu√≠ tambi√©n hay que hacer una diferencia entre lo racional y el rendimiento perfecto. Esto es, porque en general, el agente no tiene conocimiento del resultado real de sus acciones, s√≥lo tiene conocimiento del resultado esperado. Si el agente fuese omnipotente (cosa imposible en la pr√°ctica), podr√≠a maximizar la m√©trica de rendimiento real, sin embargo, un agente racional busca maximizar la m√©trica de rendimiento esperada (dado a lo que el agente espera de los resultados de sus acciones). Por ejemplo, si me env√≠an un correo diciendo que gan√© un mill√≥n de d√≥lares, y en efecto no era spam, sin embargo el agente clasificador de correos lo clasific√≥ como SPAM, por lo tanto yo decid√≠ que era SPAM, pero en la realidad no era SPAM, es algo fortuito, que el agente no pudo haber esperado. Otro ejemplo, si no viene ning√∫n auto, el sem√°foro marca verde, cruzo la calle y me cae la turbina de un avi√≥n, no puedo decir que no es racional cruzar en verde; es simplemente mala suerte. Otro ejemplo m√°s actual que se me ocurre, mi instinto ar√°cnido me dice que muchos ‚Äúmodelos predictivos‚Äù de algunas empresas no ten√≠an contemplado el COVID-19.</p>
<p>Algunas propiedades de los entornos en que un agente operar√° son:</p>
<ul>
<li>Completamente observable / parcialmente observable (¬øTengo conocimiento total del mundo o s√≥lo parcial?)</li>
<li>Determin√≠stico / Estoc√°stico (¬øEl estado siguiente se determina completamente del estado actual?)</li>
<li>Epis√≥dico / secuencial (¬ødepende mi acci√≥n siguiente de mi acci√≥n previa?)</li>
<li>Est√°tico / Din√°mico</li>
<li>Discreto / Continuo</li>
<li>Un s√≥lo agente / Multiagente</li>
</ul>
<h1 id="inteligencia-en-ia">‚ÄúInteligencia‚Äù en IA</h1>
<p>Los tipos de inteligencia en IA se pueden clasificar de acuerdo al razonamiento que hacen sobre el entorno/mundo, como se muestra en la figura 2.</p>
<div align="center">
<p><img src="https://gist.githubusercontent.com/dpalmasan/103d61ae06cfd3e7dee7888b391c1792/raw/c4d047d9403beada33098cf7e74d3d2a561e2964/line-intelligence.png" alt="intel"></p>
<p><em>Fig 2: Distintos niveles de ‚Äúinteligencia‚Äù de un agente. <a href="https://stanford-cs221.github.io/spring2020/lectures/index.html#include=overview.js&amp;mode=print1pp" target="_blank" rel="noopener noreferrer">Fuente</a>.</em></p>
</div>
<h2 id="agentes-por-reflejo">Agentes por Reflejo</h2>
<p>En este tipo de inteligencia, se encuentran agentes que act√∫an por reflejo. Consideremos un caso hip√≥tetico de un gato robot, llam√©mosle <em>RoboCat</em>. A este gato artificial le gusta jugar a seguir un punto generado por un puntero laser.</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">class</span> <span class="nc">LaserDot</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">pos</span>

    <span class="o">@</span><span class="nb">property</span>
    <span class="k">def</span> <span class="nf">pos</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">_pos</span>

    <span class="k">def</span> <span class="nf">randomize_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">RoboCat</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_next_action</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_pos</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="o">@</span><span class="nb">property</span>
    <span class="k">def</span> <span class="nf">pos</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">_pos</span>

    <span class="k">def</span> <span class="nf">perceive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">laser_dot</span><span class="p">:</span> <span class="n">LaserDot</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_next_action</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">sign</span><span class="p">(</span><span class="n">laser_dot</span><span class="p">.</span><span class="n">pos</span> <span class="o">-</span> <span class="bp">self</span><span class="p">.</span><span class="n">_pos</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_pos</span> <span class="o">+=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_next_action</span>
</code></pre></div></div>
<p>Si hacemos una simulaci√≥n simple, por ejemplo en 100 episodios:</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dot</span> <span class="o">=</span> <span class="n">LaserDot</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">RoboCat</span><span class="p">()</span>
<span class="n">dot_pos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">cat_pos</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">cat</span><span class="p">.</span><span class="n">perceive</span><span class="p">(</span><span class="n">dot</span><span class="p">)</span>
    <span class="n">cat</span><span class="p">.</span><span class="n">action</span><span class="p">()</span>
    <span class="n">dot_pos</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">dot</span><span class="p">.</span><span class="n">pos</span><span class="p">)</span>
    <span class="n">cat_pos</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">cat</span><span class="p">.</span><span class="n">pos</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cat</span><span class="p">.</span><span class="n">pos</span> <span class="o">==</span> <span class="n">dot</span><span class="p">.</span><span class="n">pos</span><span class="p">:</span>
        <span class="n">dot</span><span class="p">.</span><span class="n">randomize_pos</span><span class="p">()</span>
</code></pre></div></div>
<div align="center">
<p><img src="https://gist.githubusercontent.com/dpalmasan/103d61ae06cfd3e7dee7888b391c1792/raw/6b79839da0b7e7eb6faa893d1a80d5d6dea0dfda/cat-laser.png" alt="intel"></p>
<p><em>Fig 3: Agente reactivo ejemplo de RoboCat siguiendo un puntero laser.</em></p>
</div>
<p>En la figura 3 se muestra una simulaci√≥n en 100 episodios del gato robot siguiendo un puntero. El puntero cambia de posici√≥n aleatoriamente una vez el gato est√° en la misma posici√≥n que el puntero. Cuando el gato robot percive que el puntero est√° en otra posici√≥n intenta minimizar la distancia entre su posici√≥n y la posici√≥n del puntero.</p>
<p>En la figura 4 se muestra el controlador en alto nivel de un estanque, donde la variable controlada es la altura del estanque. En este caso, el agente tiene como referencia una altura deseada, y va sensando la altura del estanque en cada instante de tiempo. Si la altura es diferente de la deseada, el controlador la variar√° para acercarse a la altura deseada.</p>
<div align="center">
<p><img src="https://gist.githubusercontent.com/dpalmasan/103d61ae06cfd3e7dee7888b391c1792/raw/fbf482cd323764f47494ab5243cce7ffeac94ca2/estanque.png" alt="intel"></p>
<p><em>Fig 4: Ejemplo de un controlador de un estanque.</em></p>
</div>
<p>En general este tipo de inteligencia funciona muy bien para problemas donde se conocen los procesos (modelos matem√°ticos, f√≠sicos, etc), y donde el entorno no es tan cambiante.</p>
<h2 id="estados">Estados</h2>
<p>En este tipo de inteligencia, existe la noci√≥n de ‚Äúestados‚Äù, en donde el ‚Äúmundo‚Äù o ambiente en que vive el agente se representa por estados, y una acci√≥n del agente produce un cambio de estado (que puede determinista o no determinista). Luego, el agente razona sobre acciones futuras y cambios de estado y ejecuta una acci√≥n. Este proceso requiere una b√∫squeda en un espacio de estados, donde la soluci√≥n, es el camino (conjunto de acciones) que llevan desde un estado inicial hacia un estado objetivo. Cabe destacar, que un en esencia, todo problema puede ser planteado como un problema de b√∫squeda; Es m√°s, varios algoritmos requieren de alguna forma u otra, resolver problemas de b√∫squeda. Algunos ejemplos: ‚ÄúPath finding‚Äù, soluciones al puzzle de las N piezas, etc.</p>
<div align="center">
<p><img src="https://gist.githubusercontent.com/dpalmasan/103d61ae06cfd3e7dee7888b391c1792/raw/37b5f28e91e17e8d9b82dc8680de3076a95e86bc/8-puzzle.png" alt="intel"></p>
<p><em>Fig 5: Ejemplo de √°rbol de estados para el problema del 8-Puzzle</em></p>
</div>
<p>Un ejemplo cl√°sico de problema de b√∫squeda, es el puzzle de las <a href="https://en.wikipedia.org/wiki/15_puzzle" target="_blank" rel="noopener noreferrer">N-piezas</a> . Este ejemplo es generalmente mostrado en cursos de inteligencia artificial, para mostrar ejemplos de distintos algoritmos de b√∫squeda: Depth-First Search, Breadth first search, Iterative Deepening Search, Uniform Cost Search, A* Search, Iterative Deepening A* search, inserte cualquier otro algoritmo de b√∫squeda que tenga alguna optimizaci√≥n en memoria o en reducci√≥n del espacio de b√∫squeda. En la figura 5, se muestra como se va armando el √°rbol de b√∫squeda. Por otro lado, existen dos tipos de b√∫squeda, la b√∫squeda no informada y la informada. La b√∫squeda no informada es b√°sicamente hacer fuerza bruta y recorrer todo el √°rbol de b√∫squeda hasta encontrar la soluci√≥n (estado objetivo). Por otro lado, est√° la b√∫squeda informada, en la cual se proporciona informaci√≥n respecto a qu√© tan cerca (o lejos) el estado actual se encuentra del estado objetivo. Generalmente estas funciones son de la forma $h(s) = n$, donde $s$ es un estado y $n$ es una estimaci√≥n del costo que existe para ir del estado s al estado objetivo. Dependiendo de qu√© tan buena sea la heur√≠stica, se puede llegar m√°s r√°pido al estado objetivo (expandir menos nodos). En general existen dos propiedades deseables en las heur√≠sticas, admisibilidad y consistencia. La consistencia es s√≥lo importante si se explora el espacio de estados como una b√∫squeda en grafo (no repetir estados, manteniendo una agenda de estados visitados).</p>
<p>En el siguiente enlace pueden ver un demo de b√∫squeda por grafos para el puzzle de las 8 piezas: <a href="https://dpalmasan.github.io/blog-ia-dpalma/">Demo 8-puzzle A*</a></p>
<p>En general, para implementar estos algoritmos se requiere representar los estados, por ejemplo:</p>
<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">abstract</span> <span class="kd">class</span> <span class="nx">State</span> <span class="p">{</span>
    <span class="nl">prev</span><span class="p">:</span> <span class="nx">State</span>
    <span class="nx">action</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
    <span class="kd">constructor</span> <span class="p">(</span><span class="nx">prev</span><span class="p">:</span> <span class="nx">State</span><span class="p">,</span> <span class="nx">action</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">prev</span> <span class="o">=</span> <span class="nx">prev</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">action</span> <span class="o">=</span> <span class="nx">action</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">abstract</span> <span class="nx">equals</span><span class="p">(</span><span class="nx">otherState</span><span class="p">:</span> <span class="nx">State</span><span class="p">):</span> <span class="nx">boolean</span><span class="p">;</span>
    <span class="kd">abstract</span> <span class="nx">hash</span><span class="p">():</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">abstract</span> <span class="kd">class</span> <span class="nx">SearchProblem</span> <span class="p">{</span>
    <span class="kd">abstract</span> <span class="nx">getStartState</span><span class="p">()</span> <span class="p">:</span> <span class="nx">State</span><span class="p">;</span>
    <span class="kd">abstract</span> <span class="nx">isGoalState</span><span class="p">(</span><span class="nx">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">)</span> <span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
    <span class="kd">abstract</span> <span class="nx">getSuccessors</span><span class="p">(</span><span class="nx">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">)</span> <span class="p">:</span> <span class="nx">State</span><span class="p">[];</span>
    <span class="kd">abstract</span> <span class="nx">getCostOfAction</span><span class="p">(</span><span class="nx">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">)</span> <span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>El siguiente snippet muestra una implementaci√≥n simple del algoritmo A* para b√∫squeda en grafos:</p>
<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">aStar</span><span class="p">(</span><span class="nx">problem</span><span class="p">:</span> <span class="nx">SearchProblem</span><span class="p">,</span> <span class="nx">heuristic</span><span class="p">:</span> <span class="p">(</span><span class="nx">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kr">number</span> <span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">frontier</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BinaryHeap</span><span class="o">&lt;</span><span class="nx">State</span><span class="o">&gt;</span><span class="p">(</span>
        <span class="p">(</span><span class="nx">state</span><span class="p">:</span> <span class="nx">State</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">heuristic</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span> <span class="o">+</span> <span class="nx">problem</span><span class="p">.</span><span class="nx">getCostOfAction</span><span class="p">(</span><span class="nx">state</span><span class="p">));</span>

    <span class="nx">frontier</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">problem</span><span class="p">.</span><span class="nx">getStartState</span><span class="p">());</span>
    <span class="kd">let</span> <span class="nx">explored</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">StateSet</span><span class="p">();</span>

    <span class="k">while</span> <span class="p">(</span><span class="nx">frontier</span><span class="p">.</span><span class="nx">size</span><span class="p">()</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">state</span><span class="p">:</span> <span class="nx">State</span> <span class="o">=</span> <span class="nx">frontier</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
        <span class="nx">explored</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">problem</span><span class="p">.</span><span class="nx">isGoalState</span><span class="p">(</span><span class="nx">state</span><span class="p">))</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">curr</span><span class="p">:</span> <span class="nx">State</span> <span class="o">=</span> <span class="nx">state</span><span class="p">;</span>
            <span class="kd">let</span> <span class="nx">path</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">curr</span><span class="p">.</span><span class="nx">prev</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">path</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">curr</span><span class="p">.</span><span class="nx">action</span><span class="p">);</span>
                <span class="nx">curr</span> <span class="o">=</span> <span class="nx">curr</span><span class="p">.</span><span class="nx">prev</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">path</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kd">let</span> <span class="nx">neighbors</span><span class="p">:</span> <span class="nx">State</span><span class="p">[]</span> <span class="o">=</span> <span class="nx">problem</span><span class="p">.</span><span class="nx">getSuccessors</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>
        <span class="nx">neighbors</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span> <span class="p">(</span><span class="nx">neighbor</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">explored</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">neighbor</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">frontier</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">neighbor</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">});</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">[];</span>
<span class="p">}</span>
</code></pre></div></div>
<p>Nota aparte: Para resolver instancias de puzzle m√°s grande, no es suficiente usar A* (ya que la RAM es limitada y el espacio de b√∫squeda crece exponencialmente). Para resolver instancias m√°s grandes del (N^2 - 1) puzzle, siempre se puede aplicar alg√∫n algoritmo, como en este paper (<a href="http://ianparberry.com/pubs/saml.pdf" target="_blank" rel="noopener noreferrer">Combinaci√≥n de algoritmo greedy + algoritmo de b√∫squeda</a>)</p>
<p>Solo por completitud, en el siguiente video hay una demo de algunos de los algoritmos de b√∫squeda cl√°sicos, para el problema de ‚Äúpath finding‚Äù, que probablemente hice hace mucho tiempo.</p>
<p><a href="https://www.youtube.com/watch?v=PMHBzSIFPPE" target="_blank" rel="noopener noreferrer"><img src="https://img.youtube.com/vi/PMHBzSIFPPE/0.jpg" alt="PathFinding"></a></p>
<p>Otro ejemplo de problema de b√∫squeda (con teor√≠a de juegos aplicadas), es dise√±ar una IA que juegue el 2048 game. En el siguiente video se muestra un ejemplo (usa un algoritmo llamado MiniMax, basado en juegos ‚ÄúZero Sum‚Äù de teor√≠a de juegos), y el agente se pone en el peor caso (es decir siempre considera la peor situaci√≥n, lo que a veces lo lleva a hacer movidas muy conservadoras):</p>
<p><a href="https://www.youtube.com/watch?v=P1s3AyBB-j8" target="_blank" rel="noopener noreferrer"><img src="https://img.youtube.com/vi/P1s3AyBB-j8/0.jpg" alt="AdversarialSearch"></a></p>
<h2 id="variables">Variables</h2>
<p>Este tipo de problemas utilizan representaciones un poco m√°s avanzadas del mundo y del entorno, en forma de variables. Algunos ejemplos: redes Bayesianas, problemas de satisfacci√≥n de restricciones, etc. (en teor√≠a Machine Learning estar√≠a un poco m√°s adelante en la ‚Äúl√≠nea de inteligencia‚Äù mostrada anteriormente).</p>
<p>Un ejemplo cl√°sico es resolver un Sudoku:</p>
<ol>
<li>No se pueden repetir n√∫meros en las filas.</li>
<li>No se pueden repetir n√∫meros en las columnas.</li>
<li>No se pueden repetir n√∫meros en cada cuadrado del sudoku.</li>
</ol>
<p>Si consideramos que cada celda del Sudoku es una variable, tenemos 9x9 variables. Por ejemplo si a cada fila le asignamos una letra y a cada columna un valor, podr√≠amos definir las variables como:</p>
<p>$$\{A, B, C, D, E, F, G, H, I\} \times \{1, 2, 3, 4, 5, 6, 7, 8, 9\}$$</p>
<p>En este caso, el dominio de cada variable ser√° el conjunto $\{1, 2, 3, 4, 5, 6, 7, 8, 9\}$ ya que cada celda puede tomar alguno de dichos valores.</p>
<p>En el siguiente c√≥digo, hay una humilde implementaci√≥n del <a href="https://github.com/dpalmasan/DiscreteOptimization/blob/master/Week2%20-%20Constraint%20Programming/ConstraintProgramming.py" target="_blank" rel="noopener noreferrer">algoritmo AC3 para problema de satisfacci√≥n de restricciones</a>.</p>
<p>Por ejemplo podemos representar el Sudoku como un problema de satisfacci√≥n de restricciones, siguiendo las restricciones descritas:</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Sudoku</span><span class="p">(</span><span class="n">ConstraintProgrammingProblem</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sudoku</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_variables</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_domains</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_arcs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_constraints</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_unassigned_variables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_alldifferent</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">rows</span> <span class="o">=</span> <span class="s">"ABCDEFGHI"</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="s">"123456789"</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">_variables</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="bp">None</span> <span class="k">if</span> <span class="n">sudoku</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s">"0"</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">sudoku</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">_domains</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span> <span class="k">if</span> <span class="n">sudoku</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s">"0"</span> <span class="k">else</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">sudoku</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">sudoku</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s">"0"</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">_unassigned_variables</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="n">col</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                <span class="n">tmp</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">k</span><span class="p">:</span>
                        <span class="n">arc</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">k</span><span class="p">))</span>
                        <span class="k">if</span> <span class="n">arc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">_arcs</span><span class="p">:</span>
                            <span class="bp">self</span><span class="p">.</span><span class="n">_arcs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">arc</span><span class="p">)</span>
                            <span class="bp">self</span><span class="p">.</span><span class="n">_constraints</span><span class="p">[</span><span class="n">arc</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                                <span class="s">'variable["%s"] != variable["%s"]'</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span>
                            <span class="p">]</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">_alldifferent</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
                <span class="n">tmp</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">k</span><span class="p">:</span>
                        <span class="n">arc</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">((</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="n">i</span><span class="p">))</span>
                        <span class="k">if</span> <span class="n">arc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">_arcs</span><span class="p">:</span>
                            <span class="bp">self</span><span class="p">.</span><span class="n">_arcs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">arc</span><span class="p">)</span>
                            <span class="bp">self</span><span class="p">.</span><span class="n">_constraints</span><span class="p">[</span><span class="n">arc</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                                <span class="s">'variable["%s"] != variable["%s"]'</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
                            <span class="p">]</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">_alldifferent</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">row</span> <span class="o">+</span> <span class="n">col</span>
                    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">[</span><span class="n">j</span> <span class="o">*</span> <span class="mi">3</span> <span class="p">:</span> <span class="n">j</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span>
                <span class="p">]</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">_alldifferent</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">r</span> <span class="o">!=</span> <span class="n">c</span><span class="p">:</span>
                            <span class="n">arc</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
                            <span class="k">if</span> <span class="n">arc</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">_arcs</span><span class="p">:</span>
                                <span class="bp">self</span><span class="p">.</span><span class="n">_arcs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">arc</span><span class="p">)</span>
                                <span class="bp">self</span><span class="p">.</span><span class="n">_constraints</span><span class="p">[</span><span class="n">arc</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                                    <span class="s">'variable["%s"] != variable["%s"]'</span> <span class="o">%</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
                                <span class="p">]</span>

    <span class="k">def</span> <span class="nf">arcs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">_arcs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Xi</span><span class="p">,</span> <span class="n">Xj</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">_constraints</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">((</span><span class="n">Xi</span><span class="p">,</span> <span class="n">Xj</span><span class="p">))]</span>

    <span class="k">def</span> <span class="nf">neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">removable_neighbor</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">neighbors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">arc</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">_arcs</span><span class="p">:</span>
            <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span> <span class="o">=</span> <span class="n">arc</span>

            <span class="k">if</span> <span class="n">X1</span> <span class="o">==</span> <span class="n">X</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">removable_neighbor</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">removable_neighbor</span> <span class="o">!=</span> <span class="n">X2</span><span class="p">:</span>
                        <span class="n">neighbors</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">X2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">neighbors</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">X2</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">X2</span> <span class="o">==</span> <span class="n">X</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">removable_neighbor</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">removable_neighbor</span> <span class="o">!=</span> <span class="n">X1</span><span class="p">:</span>
                        <span class="n">neighbors</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">neighbors</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">neighbors</span>

    <span class="k">def</span> <span class="nf">domain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Xi</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">_domains</span><span class="p">[</span><span class="n">Xi</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">remove_from_domain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Xi</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_domains</span><span class="p">[</span><span class="n">Xi</span><span class="p">].</span><span class="n">remove</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">unassigned_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">_unassigned_variables</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">assign_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="s">"""
        Asigna un valor a la variable X
        """</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_variables</span><span class="p">[</span><span class="n">X</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="n">remove</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">_unassigned_variables</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_consistency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""
        Chequea que dada una asignaci√≥n de variables, todas las reglas del
        Sudoku se satisfacen
        """</span>
        <span class="k">for</span> <span class="n">variables</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">_alldifferent</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">)):</span>
                <span class="n">X</span> <span class="o">=</span> <span class="n">variables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">)):</span>
                    <span class="n">Y</span> <span class="o">=</span> <span class="n">variables</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">are_assigned</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">_variables</span><span class="p">[</span><span class="n">X</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span>
                        <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">_variables</span><span class="p">[</span><span class="n">Y</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">are_assigned</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">.</span><span class="n">_variables</span><span class="p">[</span><span class="n">X</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="p">.</span><span class="n">_variables</span><span class="p">[</span><span class="n">Y</span><span class="p">]:</span>
                        <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""
        Imprime en pantalla el Sudoku en su estado actual dadas las variables
        asignadas.
        """</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s">""</span>
        <span class="n">line</span> <span class="o">=</span> <span class="s">"-------------------------------------</span><span class="se">\n</span><span class="s">"</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">line</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="s">"ABCDEFGHI"</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s">"|"</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="s">"123456789"</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">_variables</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="n">col</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="s">"%3d"</span> <span class="o">%</span> <span class="bp">self</span><span class="p">.</span><span class="n">_variables</span><span class="p">[</span><span class="n">row</span> <span class="o">+</span> <span class="n">col</span><span class="p">])</span> <span class="o">+</span> <span class="s">"|"</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="s">"%3s"</span> <span class="o">%</span> <span class="s">" "</span><span class="p">)</span> <span class="o">+</span> <span class="s">"|"</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span> <span class="o">+</span> <span class="n">line</span>

        <span class="k">return</span> <span class="n">s</span>
</code></pre></div></div>
<p>Y luego ejecutar el algoritmo <code>AC3</code>:</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">example</span>  <span class="o">=</span> <span class="s">"000102900"</span>
<span class="n">example</span> <span class="o">+=</span> <span class="s">"000090301"</span>
<span class="n">example</span> <span class="o">+=</span> <span class="s">"000008006"</span>
<span class="n">example</span> <span class="o">+=</span> <span class="s">"000030000"</span>
<span class="n">example</span> <span class="o">+=</span> <span class="s">"062000000"</span>
<span class="n">example</span> <span class="o">+=</span> <span class="s">"079016000"</span>
<span class="n">example</span> <span class="o">+=</span> <span class="s">"008060007"</span>
<span class="n">example</span> <span class="o">+=</span> <span class="s">"004000190"</span>
<span class="n">example</span> <span class="o">+=</span> <span class="s">"000004020"</span>
<span class="n">cp</span> <span class="o">=</span> <span class="n">Sudoku</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span>
<span class="n">AC3</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">backtracking_search</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span>
<span class="k">for</span> <span class="n">X</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">:</span>
    <span class="n">cp</span><span class="p">.</span><span class="n">assign_variable</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">sol</span><span class="p">[</span><span class="n">X</span><span class="p">])</span>
</code></pre></div></div>
<p>Sudoku inicial:</p>
<pre><code>-------------------------------------
|   |   |   |  1|   |  2|  9|   |   |
-------------------------------------
|   |   |   |   |  9|   |  3|   |  1|
-------------------------------------
|   |   |   |   |   |  8|   |   |  6|
-------------------------------------
|   |   |   |   |  3|   |   |   |   |
-------------------------------------
|   |  6|  2|   |   |   |   |   |   |
-------------------------------------
|   |  7|  9|   |  1|  6|   |   |   |
-------------------------------------
|   |   |  8|   |  6|   |   |   |  7|
-------------------------------------
|   |   |  4|   |   |   |  1|  9|   |
-------------------------------------
|   |   |   |   |   |  4|   |  2|   |
-------------------------------------
</code></pre>
<p>Sudoku final:</p>
<pre><code>-------------------------------------
|  8|  3|  6|  1|  5|  2|  9|  7|  4|
-------------------------------------
|  2|  4|  5|  6|  9|  7|  3|  8|  1|
-------------------------------------
|  1|  9|  7|  3|  4|  8|  2|  5|  6|
-------------------------------------
|  4|  8|  1|  2|  3|  5|  7|  6|  9|
-------------------------------------
|  5|  6|  2|  4|  7|  9|  8|  1|  3|
-------------------------------------
|  3|  7|  9|  8|  1|  6|  5|  4|  2|
-------------------------------------
|  9|  2|  8|  5|  6|  1|  4|  3|  7|
-------------------------------------
|  6|  5|  4|  7|  2|  3|  1|  9|  8|
-------------------------------------
|  7|  1|  3|  9|  8|  4|  6|  2|  5|
-------------------------------------
</code></pre>
<p>En este caso, consideramos ninguna funci√≥n de costo a optimizar. Generalmente queremos minimizar/maximizar una funci√≥n y a la vez satisfacer las restricciones. Estos problemas de optimizaci√≥n son un mundo, y para que funcionen bien los algoritmos, el problema debe ser modelado de forma correcta, y algunas restricciones pueden podar el √°rbol de b√∫squeda (ej. dual de una restricci√≥n) de manera de hacer que encontrar una soluci√≥n sea factible (En el ejemplo del Sudoku, IA toma prestado conocimiento del campo de la optimizaci√≥n, para crear un agente ‚Äúinteligente‚Äù que resuelva sudokus).</p>
<h2 id="lgica">L√≥gica</h2>
<p>En este punto me extender√© un poco m√°s, ya que es un √°rea bastante interesante, adem√°s, implementar un agente l√≥gico es todo un desaf√≠o.</p>
<p>Los agentes l√≥gicos siguen una cadena de razonamiento en base a s√≠mbolos y representan el conocimiento en una base de conocimiento, de la que se obtienen inferencias en relaci√≥n a un determinado hecho. El cl√°sico ejemplo: Todo hombre es mortal; S√≥crates es Hombre; Por lo tanto S√≥crates es mortal. Este ejemplo sigue una cadena l√≥gica de razonamiento, la gran pregunta es c√≥mo representar este conocimiento de manera que autom√°ticamente un agente sea capaz de realizar inferencias y luego tomar acci√≥n. Para hacerlo m√°s entretenido, tomemos el cl√°sico ejemplo del mundo del Wumpus:</p>
<div align="center">
<p><img src="https://gist.githubusercontent.com/dpalmasan/103d61ae06cfd3e7dee7888b391c1792/raw/0b5be9b0cc96a1a00df1aa33c25a4df4309f59c0/wumpus-problem.png" alt="intel"></p>
<p><em>Fig 6: Mundo del Wumpus.</em></p>
</div>
<p>De momento consideremos lo siguiente:</p>
<ul>
<li>El mundo es una grilla de 4x4</li>
<li>Los cuadrados adyacentes al Wumpus tienen hedor del wumpus y en los cuadrados adyacentes a los precipicios, se puede percibir una brisa.</li>
<li>Se puede percibir un brillo si en la habitaci√≥n se encuentra el oro (aqu√≠ es donde nuestro agente gana el juego)</li>
</ul>
<p>M√©tricas de rendimiento:</p>
<ul>
<li>Si el agente toma el oro +1000 puntos</li>
<li>Si el agente muere (se cae a un precipicio o es comido por el Wumpus) -1000 puntos</li>
<li>-1 punto por cada acci√≥n</li>
<li>El juego termina cuando el agente toma el oro o muere.</li>
</ul>
<p>Entorno:</p>
<ul>
<li>Grilla de 4x4</li>
<li>El agente empieza en la posici√≥n <code>[1, 1]</code>
</li>
<li>Las ubicaciones del Wumpus y del Oro se escogen aleatoriamente de una distribuci√≥n uniforme de todos los cuadrados excepto del <code>[1, 1]</code>
</li>
<li>Cada cuadrado (que no sea el <code>[1, 1]</code>) tiene una probabilidad de 0.2 de ser un precipicio.</li>
</ul>
<p>Actuadores:</p>
<ul>
<li>Girar izquierda, girar derecha, avanzar, recoger</li>
</ul>
<p>Sensores:</p>
<ul>
<li>Hedor, brisa, brillo</li>
</ul>
<p>Propiedades del mundo:</p>
<ul>
<li>Parcialmente observable</li>
<li>Est√°tico</li>
<li>Discreto</li>
<li>Un s√≥lo agente</li>
<li>Determinista</li>
<li>Secuencial</li>
</ul>
<p>Primero, debemos modelar la base de conocimiento que tendr√° el agente. Ello se puede lograr por ejemplo, con l√≥gica proposicional (aqu√≠ recuerdo las clases de √°lgebra de primer a√±o y me empiezan a hacer sentido). De hecho como ejemplo tomemos la figura mostrada anteriormente. De las reglas del mundo del Wumpus, el agente deber√≠a saber:</p>
<ul>
<li>$B_{11} \leftrightarrow \left( P_{12} \lor P_{21}\right)$</li>
<li>$\neg B_{11}$</li>
</ul>
<p>En mi biblioteca opensource <a href="https://github.com/dpalmasan/py-logic" target="_blank" rel="noopener noreferrer">PyLogic</a> implemento una API para l√≥gica proposicional y para cl√°usulas de Horn (sub-conjunto de la l√≥gica de primer orden).</p>
<p>Entonces, el agente, para decidir su siguiente acci√≥n, puede preguntarse: ¬øEs <code>[1, 2]</code> seguro, o $\neg P_{12}$? Consideremos la siguiente tabla de verdad:</p>
<div align="center">
<p><img src="https://gist.githubusercontent.com/dpalmasan/103d61ae06cfd3e7dee7888b391c1792/raw/0b5be9b0cc96a1a00df1aa33c25a4df4309f59c0/truth-table-wumpus.png" alt="intel"></p>
<p><em>Fig 7: Tabla de verdad para ejemplo de consecuencia l√≥gica para determinar precipicio.</em></p>
</div>
<p>Como se ilustra en la tabla de verdad, en todo modelo en que la base de conocimiento es verdad (asignaci√≥n de variables l√≥gicas) se satisface que $\neg P_{12}$, es decir que $\neg P_{12}$ es una consecuencia l√≥gica de $\neg B_{11} \land \left(B_{11} \leftrightarrow \left(P_{12} \lor P_{21} \right)\right)$ , o, el hecho de que no haya brisa en la habitaci√≥n <code>[1, 1]</code>, significa que las habitaciones <code>[1, 2]</code>, <code>[2, 1]</code> son seguras (no hay precipicio). Ahora, podemos ver un inconveniente de hacer inferencias con tablas de verdad, y es que, crece exponencialmente con el n√∫mero de s√≠mbolos y el n√∫mero de cl√°usulas. Luego, para problemas no de juguete, no ser√≠a factible construir la tabla de verdad. Por otro lado vemos tambi√©n que al construir la tabla de verdad, entre medio se construyen muchas asignaciones innecesarias, por lo que debe haber alguna forma m√°s inteligente de llevar a cabo la ‚Äúb√∫squeda‚Äù de satisfacibilidad. Sin embargo, en esta b√∫squeda debemos tambi√©n considerar la correctitud y la completitud. Como dato extra, los problemas de satisfacibilidad Booleana son NP üòä.</p>
<p>Para automatizar un algoritmo de inferencia l√≥gica, es ideal que las cl√°usulas se puedan escribir de alguna forma can√≥nica. Por suerte, dicha forma existe y se conoce como Forma Normal Conjuntiva (del ingl√©s CNF, conjunctive normal form). De hecho, cualquier cl√°usula (por ahora en l√≥gica proposicional) se puede escribir como una conjunci√≥n de disyunciones. Tomemos como ejemplo la cl√°usula $\left(B_{11} \leftrightarrow \left(P_{12} \lor P_{21} \right)\right)$:</p>
<ol>
<li>$\left(B_{11} \rightarrow \left(P_{12} \lor P_{21}\right)\right) \land \left(\left(P_{12} \lor P_{21}\right) \rightarrow B_{11} \right)$</li>
</ol>
<p>Usando $A \rightarrow B \iff \neg A \lor B$ tenemos que:</p>
<ol start="2">
<li>$\left(\neg B_{11} \lor P_{12} \lor P_{21} \right) \land \left((\neg P_{12} \land \neg P_{21}) \lor B_{11}\right)$</li>
</ol>
<p>Distribuyendo:</p>
<ol start="3">
<li>$\left(\neg B_{11} \lor P_{12} \lor P_{21} \right) \land \left(B_{11} \lor \neg P_{12}\right) \land \left(B_{11} \lor \neg P_{21}\right)$</li>
</ol>
<p>De esta forma obtenemos 3 cl√°usulas que podemos insertar en nuestra base de conocimiento canonicalizada. Como observaci√≥n, Modus Ponens es si tengo $P$ y $P \rightarrow Q$, entonces tambi√©n tengo $Q$. En CNF, tendr√≠amos dos cl√°usulas $P \land \left(\neg P \lor Q\right)$, luego distribuyendo y resolviendo se llega a $\left(P \lor \neg P\right) \land \left(P \lor Q\right)$, y como $P \lor \neg P$ es siempre verdadero, entonces s√≥lo nos quedamos con $\left(P \lor Q\right)$. Esta ‚Äúregla‚Äù se conoce como regla de resoluci√≥n, y puede ser utilizada para realizar una demostraci√≥n por contradicci√≥n (reducci√≥n al absurdo). Volviendo al ejemplo anterior, para demostrar que <code>[1, 2]</code> es seguro (no hay precipicio), podemos seguir la siguiente cadena de razonamiento:</p>
<ol>
<li>Supongamos que hay un precipicio $P_{12}$.</li>
<li>Haciendo resoluci√≥n entre $P_{12}$ y $\neg P_{12} \lor B_{11}$, llegamos a $B_{11}$.</li>
<li>Sin embargo, tenemos en la base de conocimiento que $\neg B_{11}$ es cierto, lo que es contradictorio.</li>
<li>Por lo tanto, podemos concluir que la premisa $P_{12}$ no puede ser verdadera y por lo tanto es seguro visitar la posici√≥n <code>[1, 2]</code>.</li>
</ol>
<div align="center">
<p><img src="https://gist.githubusercontent.com/dpalmasan/103d61ae06cfd3e7dee7888b391c1792/raw/0b5be9b0cc96a1a00df1aa33c25a4df4309f59c0/resolution-algo.png" alt="intel"></p>
<p><em>Fig 8: Algoritmo de resoluci√≥n en l√≥gica proposicional.</em></p>
</div>
<p>El algoritmo de resoluci√≥n est√° <a href="https://github.com/dpalmasan/py-logic/blob/main/pylogic/propositional.py#L588" target="_blank" rel="noopener noreferrer">implementado en pylogic</a> y sigue una idea similar al pseudo-c√≥digo excepto que tiene algunas heur√≠sticas extra para hacer el algoritmo m√°s eficiente. Cabe destacar que el espacio de b√∫squeda tambi√©n crece exponencialmente con la cantidad de s√≠mbolos y cl√°usulas.</p>
<p>El lector astuto podr√° notar que para la representaci√≥n del mundo tuvimos que usar una cl√°usula para cada precipicio, hedor y brisa. Sin embargo, podemos obtener una representaci√≥n m√°s compacta. Para desarrollar esta intuici√≥n, consideremos el siguiente argumento, que es un silogismo (Arist√≥teles) cl√°sico:</p>
<p>$$
\begin{array} {c}
\text{Todo hombre es mortal} \\
\text{S√≥crates es hombre} \\
\hline
\text{S√≥crates es mortal}
\end{array}
$$</p>
<p>Cabe destacar que matem√°ticamente, estos axiomas se pueden f√≥rmular con <strong>L√≥gica de Primer Orden</strong>:</p>
<p>$$
\begin{array} {c}
\forall x (Hombre(x) \rightarrow Mortal(x)) \\
Hombre(s) \\
\hline
Mortal(s)
\end{array}
$$</p>
<p>En el caso del problema del Wumpus, por ejemplo para un precipicio, podriamos representarlo como $P(a, b)$ donde $a$ y $b$ son objetos en este universo, que representan coordenadas en el mundo del Wumpus.</p>
<p>Por otro lado, cabe destacar que existe un subconjunto de la l√≥gica en el cual consideramos s√≥lo cierto tipo de cl√°usulas. Por ejemplo, las <strong>cl√°usulas de Horn</strong> son disyunciones de literales en donde a lo m√°s un literal est√° sin negaci√≥n, por ejemplo: $\neg A \lor \neg B \lor C$ es una cl√°usula de Horn, esta puede representarse como $A \land B \rightarrow C$, es decir una conjunci√≥n de antecedentes y un consecuente. Esto permite implementar algoritmos eficientes para ciertos problemas de satisfacibilidad.</p>
<p>Consideremos el siguiente problema. Tenemos un mapa de Australia con las siguientes regiones:</p>
<ul>
<li>WA: Western Australia</li>
<li>NT: Northern Territory</li>
<li>SA: South Australia</li>
<li>Q: Queensland</li>
<li>NSW: New South Wales</li>
<li>V: Victoria</li>
</ul>
<div align="center">
<p><img src="https://gist.githubusercontent.com/dpalmasan/103d61ae06cfd3e7dee7888b391c1792/raw/37b5f28e91e17e8d9b82dc8680de3076a95e86bc/map.png" alt="intel"></p>
<p><em>Fig 9: Problema de coloreado de mapas (Australia).</em></p>
</div>
<p>Supongamos que queremos colorear el mapa de tal manera que dos regiones adyacentes no sean del mismo color. Podemos representar el problema los siguientes axiomas en modo de cl√°usulas de Horn:</p>
<p>$$
\begin{array} {   rr} \quad Diff(wa, nt) \land Diff(wa, sa) \land \\ Diff(nt, q) \land Diff(nt, sa) \land \\ Diff(q, nsw) \land Diff(q, sa) \land \\ Diff(nsw, v) \land Diff(nsw, a) \land \\ Diff(v, sa) \Rightarrow Coloreable() \\ Diff(Red, Blue) \quad Diff(Red, Green) \\ Diff(Blue, Red) \quad Diff(Blue, Green) \\ Diff(Green, Red) \quad Diff(Green, Blue) \end{array}
$$</p>
<p>Utilizando mi biblioteca pylogic:</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pylogic.fol</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">HornClauseFOL</span><span class="p">,</span>
    <span class="n">Predicate</span><span class="p">,</span>
    <span class="n">Term</span><span class="p">,</span>
    <span class="n">TermType</span><span class="p">,</span>
    <span class="n">fol_bc_ask</span><span class="p">,</span>
    <span class="n">Substitution</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">wa</span> <span class="o">=</span> <span class="n">Term</span><span class="p">(</span><span class="s">"wa"</span><span class="p">,</span> <span class="n">TermType</span><span class="p">.</span><span class="n">VARIABLE</span><span class="p">)</span>
<span class="n">sa</span> <span class="o">=</span> <span class="n">Term</span><span class="p">(</span><span class="s">"sa"</span><span class="p">,</span> <span class="n">TermType</span><span class="p">.</span><span class="n">VARIABLE</span><span class="p">)</span>
<span class="n">nt</span> <span class="o">=</span> <span class="n">Term</span><span class="p">(</span><span class="s">"nt"</span><span class="p">,</span> <span class="n">TermType</span><span class="p">.</span><span class="n">VARIABLE</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">Term</span><span class="p">(</span><span class="s">"q"</span><span class="p">,</span> <span class="n">TermType</span><span class="p">.</span><span class="n">VARIABLE</span><span class="p">)</span>
<span class="n">nsw</span> <span class="o">=</span> <span class="n">Term</span><span class="p">(</span><span class="s">"nsw"</span><span class="p">,</span> <span class="n">TermType</span><span class="p">.</span><span class="n">VARIABLE</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">Term</span><span class="p">(</span><span class="s">"v"</span><span class="p">,</span> <span class="n">TermType</span><span class="p">.</span><span class="n">VARIABLE</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Term</span><span class="p">(</span><span class="s">"t"</span><span class="p">,</span> <span class="n">TermType</span><span class="p">.</span><span class="n">VARIABLE</span><span class="p">)</span>

<span class="nb">map</span> <span class="o">=</span> <span class="n">HornClauseFOL</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">Predicate</span><span class="p">(</span><span class="s">"Diff"</span><span class="p">,</span> <span class="p">[</span><span class="n">wa</span><span class="p">,</span> <span class="n">nt</span><span class="p">]),</span>
        <span class="n">Predicate</span><span class="p">(</span><span class="s">"Diff"</span><span class="p">,</span> <span class="p">[</span><span class="n">wa</span><span class="p">,</span> <span class="n">sa</span><span class="p">]),</span>
        <span class="n">Predicate</span><span class="p">(</span><span class="s">"Diff"</span><span class="p">,</span> <span class="p">[</span><span class="n">nt</span><span class="p">,</span> <span class="n">q</span><span class="p">]),</span>
        <span class="n">Predicate</span><span class="p">(</span><span class="s">"Diff"</span><span class="p">,</span> <span class="p">[</span><span class="n">nt</span><span class="p">,</span> <span class="n">sa</span><span class="p">]),</span>
        <span class="n">Predicate</span><span class="p">(</span><span class="s">"Diff"</span><span class="p">,</span> <span class="p">[</span><span class="n">q</span><span class="p">,</span> <span class="n">nsw</span><span class="p">]),</span>
        <span class="n">Predicate</span><span class="p">(</span><span class="s">"Diff"</span><span class="p">,</span> <span class="p">[</span><span class="n">q</span><span class="p">,</span> <span class="n">sa</span><span class="p">]),</span>
        <span class="n">Predicate</span><span class="p">(</span><span class="s">"Diff"</span><span class="p">,</span> <span class="p">[</span><span class="n">nsw</span><span class="p">,</span> <span class="n">v</span><span class="p">]),</span>
        <span class="n">Predicate</span><span class="p">(</span><span class="s">"Diff"</span><span class="p">,</span> <span class="p">[</span><span class="n">nsw</span><span class="p">,</span> <span class="n">sa</span><span class="p">]),</span>
        <span class="n">Predicate</span><span class="p">(</span><span class="s">"Diff"</span><span class="p">,</span> <span class="p">[</span><span class="n">v</span><span class="p">,</span> <span class="n">sa</span><span class="p">]),</span>
    <span class="p">],</span>
    <span class="n">Predicate</span><span class="p">(</span><span class="s">"Colorable"</span><span class="p">,</span> <span class="p">[]),</span>
<span class="p">)</span>

<span class="n">red</span> <span class="o">=</span> <span class="n">Term</span><span class="p">(</span><span class="s">"Red"</span><span class="p">,</span> <span class="n">TermType</span><span class="p">.</span><span class="n">CONSTANT</span><span class="p">)</span>
<span class="n">blue</span> <span class="o">=</span> <span class="n">Term</span><span class="p">(</span><span class="s">"Blue"</span><span class="p">,</span> <span class="n">TermType</span><span class="p">.</span><span class="n">CONSTANT</span><span class="p">)</span>
<span class="n">green</span> <span class="o">=</span> <span class="n">Term</span><span class="p">(</span><span class="s">"Green"</span><span class="p">,</span> <span class="n">TermType</span><span class="p">.</span><span class="n">CONSTANT</span><span class="p">)</span>

<span class="n">p1</span> <span class="o">=</span> <span class="n">HornClauseFOL</span><span class="p">(</span>
    <span class="p">[],</span>
    <span class="n">Predicate</span><span class="p">(</span><span class="s">"Diff"</span><span class="p">,</span> <span class="p">[</span><span class="n">red</span><span class="p">,</span> <span class="n">blue</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">HornClauseFOL</span><span class="p">(</span>
    <span class="p">[],</span>
    <span class="n">Predicate</span><span class="p">(</span><span class="s">"Diff"</span><span class="p">,</span> <span class="p">[</span><span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">HornClauseFOL</span><span class="p">(</span>
    <span class="p">[],</span>
    <span class="n">Predicate</span><span class="p">(</span><span class="s">"Diff"</span><span class="p">,</span> <span class="p">[</span><span class="n">green</span><span class="p">,</span> <span class="n">red</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">p4</span> <span class="o">=</span> <span class="n">HornClauseFOL</span><span class="p">(</span>
    <span class="p">[],</span>
    <span class="n">Predicate</span><span class="p">(</span><span class="s">"Diff"</span><span class="p">,</span> <span class="p">[</span><span class="n">green</span><span class="p">,</span> <span class="n">blue</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">p5</span> <span class="o">=</span> <span class="n">HornClauseFOL</span><span class="p">(</span>
    <span class="p">[],</span>
    <span class="n">Predicate</span><span class="p">(</span><span class="s">"Diff"</span><span class="p">,</span> <span class="p">[</span><span class="n">blue</span><span class="p">,</span> <span class="n">red</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">p6</span> <span class="o">=</span> <span class="n">HornClauseFOL</span><span class="p">([],</span> <span class="n">Predicate</span><span class="p">(</span><span class="s">"Diff"</span><span class="p">,</span> <span class="p">[</span><span class="n">blue</span><span class="p">,</span> <span class="n">green</span><span class="p">]))</span>

<span class="n">kb</span> <span class="o">=</span> <span class="p">[</span><span class="nb">map</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">,</span> <span class="n">p5</span><span class="p">,</span> <span class="n">p6</span><span class="p">]</span>

<span class="n">goal</span> <span class="o">=</span> <span class="n">Predicate</span><span class="p">(</span><span class="s">"Colorable"</span><span class="p">,</span> <span class="p">[])</span>
<span class="n">answers</span> <span class="o">=</span> <span class="n">fol_bc_ask</span><span class="p">(</span><span class="n">kb</span><span class="p">,</span> <span class="p">[</span><span class="n">goal</span><span class="p">],</span> <span class="n">Substitution</span><span class="p">({}))</span>

<span class="k">for</span> <span class="n">answer</span> <span class="ow">in</span> <span class="n">answers</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">answer</span><span class="p">.</span><span class="n">substitution_values</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"="</span> <span class="o">*</span> <span class="mi">7</span><span class="p">)</span>
</code></pre></div></div>
<p>La cual entrega m√∫ltiples soluciones, por ejemplo:</p>
<div align="center">
<p><img src="https://gist.githubusercontent.com/dpalmasan/103d61ae06cfd3e7dee7888b391c1792/raw/37b5f28e91e17e8d9b82dc8680de3076a95e86bc/maps.drawio.png" alt="intel"></p>
<p><em>Fig 10: Soluciones entregadas por PyLogic para el problema de coloreado de mapas.</em></p>
</div>
<h1 id="un-poco-ms-sobre-problemas-de-bsqueda">Un poco m√°s sobre problemas de b√∫squeda</h1>
<p>Gran parte de la IA, puede reducirse a un problema de b√∫squeda.</p>
<ul>
<li>En machine learning estamos buscando ‚Äúel mejor modelo‚Äù en base a alg√∫n criterio (por ejemplo ajuste de datos)</li>
<li>En problemas de estados, estamos buscando ‚Äúel mejor camino‚Äù para llegar de un estado inicial a un estado objetivo</li>
<li>En l√≥gica dada una cl√°usula y una base de conocimiento estamos buscando si esta cl√°usula se puede satisfacer dado el conocimiento embebido en la base.</li>
<li>En problemas de satisfacci√≥n de restricciones, estamos buscando la soluci√≥n que cumpla todas las restricciones y que minimice o maximice una funci√≥n objetivo.</li>
</ul>
<p>El c√≥mo se hace la b√∫squeda es donde uno tiene que poner cerebro a resolver el problema.</p>
<h2 id="ejemplo-de-estimacin-de-parmetros">Ejemplo de Estimaci√≥n de Par√°metros</h2>
<p>Supongamos que tenemos los siguientes datos:</p>
<ul>
<li><code>t = [0., 0.11111111, 0.22222222, 0.33333333, 0.44444444, 0.55555556, 0.66666667, 0.77777778, 0.88888889, 1.]</code></li>
<li><code>v = [100.96510126, 67.78222915, 48.48101823, 24.98947315, 18.23139621, 12.91163503, 5.18434069, 7.19801177, 4.63123254, 1.91433441]</code></li>
</ul>
<p>Queremos encontrar un modelo que ajuste dichos datos. Supongamos que estudiamos el modelo f√≠sico:</p>
<p>$$v(t) = v_0 \cdot e^{-\frac{t}{\tau}}$$</p>
<p>En este caso podemos transformar el problema a uno lineal en sus par√°metros ($v_0$ y $\tau$):</p>
<ul>
<li>$log\left(v\left(t\right)\right) = log\left(v_0\right) + log\left(e^{-\frac{t}{\tau}}\right)$</li>
<li>$log\left(v\left(t\right)\right) = a - b\cdot t$</li>
</ul>
<p>Luego aplicar m√≠nimos cuadrados para encontrar $a$ y $b$ y re-transformar a los par√°metros originales:</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">V0</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">t_truth</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.11111111</span><span class="p">,</span>
        <span class="mf">0.22222222</span><span class="p">,</span>
        <span class="mf">0.33333333</span><span class="p">,</span>
        <span class="mf">0.44444444</span><span class="p">,</span>
        <span class="mf">0.55555556</span><span class="p">,</span>
        <span class="mf">0.66666667</span><span class="p">,</span>
        <span class="mf">0.77777778</span><span class="p">,</span>
        <span class="mf">0.88888889</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="mf">100.96510126</span><span class="p">,</span>
        <span class="mf">67.78222915</span><span class="p">,</span>
        <span class="mf">48.48101823</span><span class="p">,</span>
        <span class="mf">24.98947315</span><span class="p">,</span>
        <span class="mf">18.23139621</span><span class="p">,</span>
        <span class="mf">12.91163503</span><span class="p">,</span>
        <span class="mf">5.18434069</span><span class="p">,</span>
        <span class="mf">7.19801177</span><span class="p">,</span>
        <span class="mf">4.63123254</span><span class="p">,</span>
        <span class="mf">1.91433441</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="p">.</span><span class="n">ones</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">shape</span><span class="p">),</span> <span class="o">-</span><span class="n">t</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="n">sol</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">T</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="n">V0_approx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">tau_approx</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">sol</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"V0 = </span><span class="si">{</span><span class="n">V0</span><span class="si">}</span><span class="s">; tau = </span><span class="si">{</span><span class="n">tau</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="n">V_truth</span> <span class="o">=</span> <span class="n">V0</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t_truth</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span>
<span class="n">V_approx</span> <span class="o">=</span> <span class="n">V0_approx</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t_truth</span> <span class="o">/</span> <span class="n">tau_approx</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_truth</span><span class="p">,</span> <span class="n">V_truth</span><span class="p">,</span> <span class="s">"-b"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="s">"*r"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_truth</span><span class="p">,</span> <span class="n">V_approx</span><span class="p">,</span> <span class="s">"-g"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">((</span><span class="s">"Funci√≥n Original"</span><span class="p">,</span> <span class="s">"Medidas con ruido"</span><span class="p">,</span> <span class="s">"Soluci√≥n encontrada"</span><span class="p">))</span>
</code></pre></div></div>
<p>La salida del programa previo es:</p>
<pre><code>V0 = 100; tau = 0.25
V0_approx = 99.8009989146457; tau_approx = 0.2654186277602548
</code></pre>
<div align="center">
<p><img src="https://gist.githubusercontent.com/dpalmasan/103d61ae06cfd3e7dee7888b391c1792/raw/0b5be9b0cc96a1a00df1aa33c25a4df4309f59c0/finding_example.png" alt="intel"></p>
<p><em>Fig 11: Ejemplo de b√∫squeda de par√°metros por m√≠nimos cuadrados.</em></p>
</div>
<p>El resultado indica que podemos estimar los par√°metros y dependiendo del ruido en los datos la estimaci√≥n ser√° cercana a los par√°metros reales del modelo. Pregunta para el lector ¬øQu√© ocurre en el caso de outliers extremos? ¬øC√≥mo lidiar con estos casos?</p>
<h2 id="pddl-planning-domain-definition-language">PDDL: Planning Domain Definition Language</h2>
<p><em>PDDL</em> es un lenguaje estandarizado desarrollado para agentes que resuelven problemas de planificaci√≥n. El lenguaje es flexible y tiene los siguientes requerimientos:</p>
<ul>
<li>
<p>Definir el dominio del problema</p>
<ul>
<li>Los predicados: van a ser estados que puedene ser verdaderos o falsos. Por ejemplo <code>in x</code>, <code>visited x</code>, <code>connected x y</code>
</li>
<li>Acciones: Las acciones tienen <strong>pre-requisitos</strong> y efectos. Por ejemplo si el agente se encuentra en la posici√≥n <code>a</code> (<code>in a</code>), <code>a</code> est√° conectado con b, <code>connected a b</code>, se puede tener la acci√≥n <code>move x y</code> cuyo <strong>efecto</strong> sea: <code>in y</code>, <code>visited y</code> y remover <code>in a</code> (hacer este predicado falso)</li>
<li>Cada acci√≥n puede tener un <strong>costo</strong> asociado.</li>
</ul>
</li>
<li>
<p>Tener una instancia del problema, para la cual se haga el plan.</p>
</li>
</ul>
<p>Supongamos que tenemos un mapa de ciudades, y queremos recorrer todas las ciudades en el m√≠nimo de tiempo posible hasta volver al punto inicial.</p>
<div align="center">
<p><img src="https://gist.githubusercontent.com/dpalmasan/103d61ae06cfd3e7dee7888b391c1792/raw/1713a4dbddccb96f32b8e0d00a3e3c735c0a442e/tsp.png" alt="intel"></p>
<p><em>Fig 12: Ejemplo de mapa de ciudades.</em></p>
</div>
<p>En este caso, en PDDL el dominio ser√≠a:</p>
<pre><code class="language-pddl">(define (domain tsp-strips)
  (:requirements :strips)
  (:predicates (in ?x) (visited ?x) (not-visited ?x)
	       (starting ?x) (complete) (not-complete)
	       (connected ?x ?y))

  (:action go-along
    :parameters (?x ?y)
    :precondition (and (in ?x) (not-visited ?y) (not-complete)
		       (connected ?x ?y))
    :effect (and (not (in ?x)) (in ?y) (visited ?y) (not (not-visited ?y))))

  (:action return-along
    :parameters (?x ?y)
    :precondition (and (in ?x) (starting ?y) (not-complete)
		       (connected ?x ?y))
    :effect (and (not (in ?x)) (in ?y) (not (not-complete)) (complete)))

 )
</code></pre>
<p>Ahora definamos la instancia en <code>PDDL</code>:</p>
<pre><code class="language-pddl">(define (problem ten-cities)
  (:domain tsp-strips)
  (:objects c1 c2 c3 c4 c5 c6 c7 c8 c9 c10)
  (:init (connected c1 c2) (connected c1 c3) (connected c2 c4)
         (connected c2 c5) (connected c3 c6) (connected c3 c7)
         (connected c4 c8) (connected c4 c9) (connected c5 c10)
         (connected c5 c1) (connected c6 c2) (connected c6 c3)
         (connected c7 c4) (connected c7 c5) (connected c8 c6)
         (connected c8 c7) (connected c9 c8) (connected c10 c1)
         (visited c1) (not-visited c2) (not-visited c3)
         (not-visited c4) (not-visited c5) (not-visited c6)
         (not-visited c7) (not-visited c8) (not-visited c9)
         (not-visited c10)
         (in c1) (starting c1) (not-complete))
  (:goal (and (visited c1) (visited c2) (visited c3) (visited c4)
              (visited c5) (visited c6) (visited c7) (visited c8)
              (visited c9) (visited c10) (complete)))
  )
</code></pre>
<p>El plan retornado por un planner por ejemplo ser√≠a el mostrado en la figura 13.</p>
<pre><code>(go-along c1 c2)
(go-along c2 c4)
(go-along c4 c9)
(go-along c9 c8)
(go-along c8 c6)
(go-along c6 c3)
(go-along c3 c7)
(go-along c7 c5)
(go-along c5 c10)
(return-along c10 c1)
</code></pre>
<div align="center">
<p><img src="https://gist.githubusercontent.com/dpalmasan/103d61ae06cfd3e7dee7888b391c1792/raw/1713a4dbddccb96f32b8e0d00a3e3c735c0a442e/tsp-sol-pddl.png" alt="intel"></p>
<p><em>Fig 13: Ejemplo de b√∫squeda de par√°metros por m√≠nimos cuadrados.</em></p>
</div>
<h2 id="agentes-llm">¬øAgentes LLM?</h2>
<p>Con los LLM y las nuevas tendencias en la industria, sale el concepto de agentes con LLMs. Estos agentes funcionan en un dominio abierto y son capaces de generar un plan como una consulta en lenguaje natural. Existen frameworks para connectar LLMs como <a href="https://python.langchain.com/v0.1/docs/modules/agents/" target="_blank" rel="noopener noreferrer">LangChain</a>.</p>
<p>Ahora ¬øQu√© soluci√≥n es mejor? Depende del problema, requerimientos, conocimiento de expertos del dominio y coste dispuesto a pagar (no es barato hacer inferencias con LLM dependiendo de las queries a considerar, por ejemplo QPS).</p>
<h1 id="reflexiones">Reflexiones</h1>
<ul>
<li>Se pueden clasificar distintos tipos de agentes dependiendo de la ‚Äúinteligencia‚Äù de estos. La inteligencia en este caso es una definici√≥n simplista que denota el nivel sofisticaci√≥n del agente</li>
<li>Todos los enfoques pueden reducirse a un problema de b√∫squeda. La estrategia cambia, y escoger cu√°l utilizar depender√° del problema a resolver.</li>
<li>Existen lenguajes estandarizados para definir dominios y agentes.</li>
<li>Las nuevas tendencias utilizan agentes que utilizan LLMs para el razonamiento y construcci√≥n de un plan. La ‚Äúmejor‚Äù soluci√≥n depender√° de las restricciones del problema.</li>
</ul>
<p>Espero que el art√≠culo haya sido interesante üòä. ¬°Abrazos!</p>

  </div>
<div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = '';
      this.page.identifier = 'https://dpalmasan.github.io/website/algorithms/ai/2024/06/20/agents-ai.html';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://dpalmasan.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow noopener noreferrer" target="_blank">comments powered by Disqus.</a>
</noscript>
<a class="u-url" href="/website/algorithms/ai/2024/06/20/agents-ai.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/website/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="https://dpalmasan.github.io/website/feed.xml">
            <svg class="svg-icon orange">
              <path d="M12.8 16C12.8 8.978 7.022 3.2 0 3.2V0c8.777 0 16 7.223 16 16h-3.2zM2.194
                11.61c1.21 0 2.195.985 2.195 2.196 0 1.21-.99 2.194-2.2 2.194C.98 16 0 15.017 0
                13.806c0-1.21.983-2.195 2.194-2.195zM10.606
                16h-3.11c0-4.113-3.383-7.497-7.496-7.497v-3.11c5.818 0 10.606 4.79 10.606 10.607z"></path>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">dpalmasan</li>
          
        </ul>
      </div>
      <div class="footer-col">
        <p>Este es un blog donde compartir√© un poco sobre m√≠ y mis experiencias en el mundo tecnol√≥gico...</p>
      </div>
    </div>

    <div class="social-links">
<ul class="social-media-list">
<li>
    <a rel="me noopener noreferrer" href="https://www.linkedin.com/in/dpalmasan/" target="_blank" title="Mi perfil en Linkedin">
      <span class="grey fa-brands fa-linkedin fa-lg"></span>
    </a>
  </li>
<li>
    <a rel="me noopener noreferrer" href="https://www.github.com/dpalmasan" target="_blank" title="Mi Github">
      <span class="grey fa-brands fa-github fa-lg"></span>
    </a>
  </li>
<li>
    <a rel="me noopener noreferrer" href="https://scholar.google.com/citations?user=Y5PN_1AAAAAJ&hl=en" target="_blank" title="Mi Google Scholar">
      <span class="grey fa-brands fa-google-scholar fa-lg"></span>
    </a>
  </li>
<li>
    <a rel="me noopener noreferrer" href="https://stackoverflow.com/users/4051219/dpalma" target="_blank" title="Mis preguntas en SO LOL!">
      <span class="grey fa-brands fa-stack-overflow fa-lg"></span>
    </a>
  </li>
</ul>
</div>

  </div>

</footer>

</body>

</html>
